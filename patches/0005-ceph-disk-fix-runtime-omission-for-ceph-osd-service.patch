From 67f56c5d882c8e4bed3d404825da3454732ca32a Mon Sep 17 00:00:00 2001
From: Carl Xiong <xiongc05@gmail.com>
Date: Fri, 22 Sep 2017 11:55:33 +0800
Subject: [PATCH 5/5] ceph-disk: fix '--runtime' omission for ceph-osd service
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

f425a127b introduces a regression that ceph-disk omits "--runtime" when
enabling ceph-osd@$ID.service units for device-backed OSDs.

Fixes: http://tracker.ceph.com/issues/21498

Signed-off-by: Carl Xiong <cxiong@suse.com>
(cherry picked from commit a385b5b0c35106c9b44d81655983b2f7566b21cd)
Signed-off-by: Fabian Gr√ºnbichler <f.gruenbichler@proxmox.com>
---
 src/ceph-disk/ceph_disk/main.py | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/ceph-disk/ceph_disk/main.py b/src/ceph-disk/ceph_disk/main.py
index 8b0c5dbc38..6482ba7dee 100755
--- a/src/ceph-disk/ceph_disk/main.py
+++ b/src/ceph-disk/ceph_disk/main.py
@@ -3248,7 +3248,7 @@ def systemd_start(
     osd_id,
 ):
     systemd_disable(path, osd_id)
-    if is_mounted(path):
+    if os.path.ismount(path):
         style = ['--runtime']
     else:
         style = []
-- 
2.14.1

