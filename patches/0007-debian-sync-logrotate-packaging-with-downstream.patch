From 1e190c864e37ea2e76a0d41f10576186697d6521 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Fabian=20Gr=C3=BCnbichler?= <f.gruenbichler@proxmox.com>
Date: Tue, 6 Jun 2017 12:20:06 +0200
Subject: [PATCH 7/7] debian: sync logrotate packaging with downstream
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

both Ubuntu and Debian put the logrotate script into
ceph-common, to ensure that radosgw logs are rotated as
well.

to prevent duplicate logrotate scripts handling the same log
files, and to minimize the delta between upstream and
downstream packaging, sync this change back upstream.

Signed-off-by: Fabian Gr√ºnbichler <f.gruenbichler@proxmox.com>
---
 debian/ceph-base.maintscript | 1 +
 debian/rules                 | 4 ++--
 2 files changed, 3 insertions(+), 2 deletions(-)
 create mode 100644 debian/ceph-base.maintscript

diff --git a/debian/ceph-base.maintscript b/debian/ceph-base.maintscript
new file mode 100644
index 0000000000..13c9f25adb
--- /dev/null
+++ b/debian/ceph-base.maintscript
@@ -0,0 +1 @@
+rm_conffile /etc/logrotate.d/ceph.logrotate -- "$@"
diff --git a/debian/rules b/debian/rules
index e12913c6d7..aeb826b33e 100755
--- a/debian/rules
+++ b/debian/rules
@@ -52,8 +52,8 @@ override_dh_installdocs:
 	dh_installdocs -a --all ChangeLog
 
 override_dh_installlogrotate:
-	cp src/logrotate.conf debian/ceph-base.ceph.logrotate
-	dh_installlogrotate -pceph-base --name=ceph
+	cp src/logrotate.conf debian/ceph-common.logrotate
+	dh_installlogrotate -pceph-common
 
 override_dh_installinit:
 	# dh_installinit is only set up to handle one upstart script
-- 
2.11.0

