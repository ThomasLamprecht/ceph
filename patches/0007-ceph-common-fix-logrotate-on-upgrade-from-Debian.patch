From da20a6c3188f37b1f3fe30c651a90fc17e46b148 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Fabian=20Gr=C3=BCnbichler?= <f.gruenbichler@proxmox.com>
Date: Tue, 6 Jun 2017 12:20:06 +0200
Subject: [PATCH 7/7] ceph-common: fix logrotate on upgrade from Debian
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

Signed-off-by: Fabian Gr√ºnbichler <f.gruenbichler@proxmox.com>
---
 debian/ceph-common.postinst | 2 ++
 debian/ceph-common.postrm   | 2 ++
 debian/ceph-common.preinst  | 5 +++++
 3 files changed, 9 insertions(+)
 create mode 100755 debian/ceph-common.preinst

diff --git a/debian/ceph-common.postinst b/debian/ceph-common.postinst
index 719dc79..a431b9a 100644
--- a/debian/ceph-common.postinst
+++ b/debian/ceph-common.postinst
@@ -99,6 +99,8 @@ case "$1" in
     ;;
 esac
 
+dpkg-maintscript-helper rm_conffile /etc/logrotate.d/ceph-common -- "$@"
+
 # dh_installdeb will replace this with shell code automatically
 # generated by other debhelper scripts.
 
diff --git a/debian/ceph-common.postrm b/debian/ceph-common.postrm
index b621854..63cfe4f 100644
--- a/debian/ceph-common.postrm
+++ b/debian/ceph-common.postrm
@@ -37,6 +37,8 @@ case "$1" in
     ;;
 esac
 
+dpkg-maintscript-helper rm_conffile /etc/logrotate.d/ceph-common -- "$@"
+
 # dh_installdeb will replace this with shell code automatically
 # generated by other debhelper scripts.
 
diff --git a/debian/ceph-common.preinst b/debian/ceph-common.preinst
new file mode 100755
index 0000000..3bc000e
--- /dev/null
+++ b/debian/ceph-common.preinst
@@ -0,0 +1,5 @@
+#!/bin/sh
+
+set -e
+
+dpkg-maintscript-helper rm_conffile /etc/logrotate.d/ceph-common -- "$@"
-- 
2.1.4

