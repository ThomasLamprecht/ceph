From 69fa7d657d2b849c7d472a2aa8965fa858bc4fd1 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Fabian=20Gr=C3=BCnbichler?= <f.gruenbichler@proxmox.com>
Date: Mon, 4 Dec 2017 10:23:30 +0100
Subject: [PATCH 6/6] Revert "ceph-disk add deprecation warnings in favor of
 ceph-volume"
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

This reverts commit b8bf0d047868054135592188c7ebe186181310c5.

Signed-off-by: Fabian Gr√ºnbichler <f.gruenbichler@proxmox.com>
---
 src/ceph-disk/ceph_disk/main.py | 29 +----------------------------
 1 file changed, 1 insertion(+), 28 deletions(-)

diff --git a/src/ceph-disk/ceph_disk/main.py b/src/ceph-disk/ceph_disk/main.py
index 6516750d22..6d1a555ead 100644
--- a/src/ceph-disk/ceph_disk/main.py
+++ b/src/ceph-disk/ceph_disk/main.py
@@ -42,23 +42,12 @@ import pwd
 import grp
 import textwrap
 import glob
-import warnings
 
 CEPH_OSD_ONDISK_MAGIC = 'ceph osd volume v026'
 CEPH_LOCKBOX_ONDISK_MAGIC = 'ceph lockbox volume v001'
 
 KEY_MANAGEMENT_MODE_V1 = 'ceph-mon v1'
 
-DEPRECATION_WARNING = """
-*******************************************************************************
-This tool is now deprecated in favor of ceph-volume.
-It is recommended to use ceph-volume for OSD deployments. For details see:
-
-    http://docs.ceph.com/docs/master/ceph-volume/#migrating
-
-*******************************************************************************
-"""
-
 PTYPE = {
     'regular': {
         'journal': {
@@ -5649,8 +5638,6 @@ def make_zap_parser(subparsers):
 
 
 def main(argv):
-    # Deprecate from the very beginning
-    warnings.warn(DEPRECATION_WARNING)
     args = parse_args(argv)
 
     setup_logging(args.verbose, args.log_stdout)
@@ -5670,20 +5657,10 @@ def main(argv):
     CEPH_PREF_GROUP = args.setgroup
 
     if args.verbose:
-        try:
-            args.func(args)
-        except Exception:
-            # warn on any exception when running with verbosity
-            warnings.warn(DEPRECATION_WARNING)
-            # but still raise the original issue
-            raise
-
+        args.func(args)
     else:
         main_catch(args.func, args)
 
-    # if there aren't any errors, still log again at the very bottom
-    warnings.warn(DEPRECATION_WARNING)
-
 
 def setup_logging(verbose, log_stdout):
     loglevel = logging.WARNING
@@ -5710,8 +5687,6 @@ def main_catch(func, args):
         func(args)
 
     except Error as e:
-        # warn on generic 'error' exceptions
-        warnings.warn(DEPRECATION_WARNING)
         raise SystemExit(
             '{prog}: {msg}'.format(
                 prog=args.prog,
@@ -5720,8 +5695,6 @@ def main_catch(func, args):
         )
 
     except CephDiskException as error:
-        # warn on ceph-disk exceptions
-        warnings.warn(DEPRECATION_WARNING)
         exc_name = error.__class__.__name__
         raise SystemExit(
             '{prog} {exc_name}: {msg}'.format(
-- 
2.14.2

