From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Thomas Lamprecht <t.lamprecht@proxmox.com>
Date: Wed, 2 Jul 2025 18:07:24 +0200
Subject: [PATCH] debian: do not ship legacy init.d ceph script anymore

It has been replaced by systemd units since quite a while.

Signed-off-by: Thomas Lamprecht <t.lamprecht@proxmox.com>
Signed-off-by: Max R. Carrara <m.carrara@proxmox.com>
---
 debian/ceph-base.install     | 1 -
 debian/ceph-base.maintscript | 1 +
 debian/rules                 | 2 --
 3 files changed, 1 insertion(+), 3 deletions(-)

diff --git a/debian/ceph-base.install b/debian/ceph-base.install
index 140551187ba..92fbd13cbc8 100644
--- a/debian/ceph-base.install
+++ b/debian/ceph-base.install
@@ -1,4 +1,3 @@
-etc/init.d/ceph
 {usr/,}lib/systemd/system/ceph-crash.service
 usr/bin/ceph-crash
 usr/bin/ceph-debugpack
diff --git a/debian/ceph-base.maintscript b/debian/ceph-base.maintscript
index 196dc084135..aa257a14632 100644
--- a/debian/ceph-base.maintscript
+++ b/debian/ceph-base.maintscript
@@ -1,2 +1,3 @@
 rm_conffile /etc/logrotate.d/ceph
 rm_conffile /etc/logrotate.d/ceph.logrotate
+rm_conffile /etc/init.d/ceph 19.2.2-pve6~ ceph-base
diff --git a/debian/rules b/debian/rules
index fa7e55b03be..212b931d21e 100755
--- a/debian/rules
+++ b/debian/rules
@@ -101,8 +101,6 @@ override_dh_installinit:
 	install -m0644 etc/default/ceph debian/ceph-common/etc/default/
 	install -d -m0755 debian/ceph-common/usr/lib/tmpfiles.d
 	install -m 0644 -D systemd/ceph.tmpfiles.d debian/ceph-common/usr/lib/tmpfiles.d/ceph.conf
-
-	dh_installinit -p ceph-base --name ceph --no-start
 	dh_installinit -p radosgw --no-start
 
 override_dh_installsystemd:
