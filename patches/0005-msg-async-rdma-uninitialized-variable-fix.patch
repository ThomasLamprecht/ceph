From 166210c6005403d06e221db9bc97f70a6a43df5e Mon Sep 17 00:00:00 2001
From: Vasily Philipov <vasilyf@mellanox.com>
Date: Tue, 3 Oct 2017 12:15:13 +0300
Subject: [PATCH 5/6] msg/async/rdma: uninitialized variable fix
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

When port constructor is called gid_idx variable stays uninitialized if
"#else" case is acting.

Signed-off-by: Vasily Philipov <vasilyf@mellanox.com>
(cherry picked from commit 7ba25bb52a66566c52b352bd6f05794853a6cdca)
Signed-off-by: Fabian Gr√ºnbichler <f.gruenbichler@proxmox.com>
---
 src/msg/async/rdma/Infiniband.cc | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/msg/async/rdma/Infiniband.cc b/src/msg/async/rdma/Infiniband.cc
index 37e1a53077..06f514fe24 100644
--- a/src/msg/async/rdma/Infiniband.cc
+++ b/src/msg/async/rdma/Infiniband.cc
@@ -28,7 +28,7 @@ static const uint32_t MAX_INLINE_DATA = 0;
 static const uint32_t TCP_MSG_LEN = sizeof("0000:00000000:00000000:00000000:00000000000000000000000000000000");
 static const uint32_t CQ_DEPTH = 30000;
 
-Port::Port(CephContext *cct, struct ibv_context* ictxt, uint8_t ipn): ctxt(ictxt), port_num(ipn), port_attr(new ibv_port_attr)
+Port::Port(CephContext *cct, struct ibv_context* ictxt, uint8_t ipn): ctxt(ictxt), port_num(ipn), port_attr(new ibv_port_attr), gid_idx(0)
 {
 #ifdef HAVE_IBV_EXP
   union ibv_gid cgid;
-- 
2.14.2

